#!/usr/bin/env bash


status_line=$(tmux capture-pane -pS -  | rg -e "(?:NOR\s+|NORMAL|INS\s+|INSERT|SEL\s+|SELECT)\s+[\x{2800}-\x{28FF}]*\s+(\S*)\s[^â”‚]* (\d+):(\d+).*" -o --replace '$1 $2 $3')
buffer_path=$(echo "$status_line" | awk '{ print $1}')
buffer_path=$(realpath "$buffer_path")  # Convert filename to absolute path
cursor_col=$(echo "$status_line" | awk '{ print $3}')
cursor_row=$(echo "$status_line" | awk '{ print $2}')

pwd=$(pwd)
pwd_hash=$(echo -n "$PWD" | md5sum | awk '{ print $1 }')
basedir=$(dirname "$buffer_path")
basename=$(basename "$buffer_path")
basename_without_extension="${basename%.*}"
extension="${buffer_path##*.}"

cache_dir="$HOME/.cache/helix_harpoon"
data_file="$HOME/.cache/helix_harpoon/$pwd_hash.txt"

mkdir -p "$cache_dir"
touch "$data_file"

# echo "Filename: $filename" > output.txt
# echo "Cursor Column: $cursor_col" >> output.txt
# echo "Cursor Row: $cursor_row" >> output.txt


: '
gn/p:
  update current cursor position with path
  helix_harpoon_update_buffer.sh

spacef:
  update current cursor position with path
  helix_harpoon_update_buffer.sh

ctrl+h:
  save current buffer to harpoon
  helix_harpoon_add_buffer.sh

ctrl+jkl;:
  switch to specific buffer, first arg is index
  helix_harpoon_switch_buffer.sh <idx>


prefix+h:
  harpoon editor in floating helix
  helix_harpoon_edit.sh

harpoon list is saved based on pwd.
Each list is stored at:
~/.cache/helix_harpoon/<pwd_hash>.txt
'
