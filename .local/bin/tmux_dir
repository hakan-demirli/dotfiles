#!/usr/bin/env bash

session_name=$(uuidgen)
tmp="$(mktemp -t "yazi-cwd.XXXXX")"
yazi --cwd-file="$tmp"
if [ -f "$tmp" ]; then
	dir="$(command cat "$tmp")"
	rm -f "$tmp"
	if [ -d "$dir" ]; then
		if [ "$dir" != "$(pwd)" ]; then
			cd "$dir"
			exec "${SHELL:-sh}"
      tmux new-session -d -s "$session_name" -n myWindow
      tmux send-keys -t "$session_name:myWindow" "ya" Enter
      tmux attach -t "$session_name"
		fi
	fi
fi
