#!/usr/bin/env bash

mapfile -d '' files < <(find "$HOME/Desktop/images/art/pc_wp" -maxdepth 1 -type f -print0 | sort -z)

if [ ${#files[@]} -eq 0 ]; then
  echo "No images found in $HOME/Desktop/images/art/pc_wp"
  exit 1
fi

index=$(($(date +%j) % ${#files[@]}))
selected="${files[$index]}"

swww img "$selected"

rm -f "$HOME/.mozilla/firefox/emre/chrome/wp.png" && cp "$selected" "$HOME/.mozilla/firefox/emre/chrome/wp.png"

cp "$selected" "/tmp/wp.webp"

ffmpeg -y -i /tmp/wp.webp -vf "scale='if(gte(a,1920/1080),-1,1920)':'if(gte(a,1920/1080),1080,-1)',crop=1920:1080" /tmp/wp.png
